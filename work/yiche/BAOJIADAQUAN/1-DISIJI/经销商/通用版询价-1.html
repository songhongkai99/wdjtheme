<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <title>通用版询价-1</title>
    <link rel="stylesheet" type="text/css" href="http://192.168.0.10:8888/m/20150514移动站改版/2015公共控件.css" />
    <link rel="stylesheet" type="text/css" href="http://192.168.0.10:8888/m/20150514移动站改版/2015选车工具.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
    <link rel="stylesheet" type="text/css" href="../css/jingxiaoshang_yanghu.css" />
    <!-- <link rel="stylesheet" type="text/css" href="http://image.bitautoimg.com/uimg/css/00040/4th_2015-2_jingxiaoshang_style-20160108102646-1036.css" media="all" />-->
    <!-- #include file="/ushtml/0000/4th_2015-2_jingxiaoshang_style-1011.shtml" -->
</head>
<body>
    <div class="ask-box nomedia">
        <header>
            <h2>询价</h2>
        </header>
        <div class="con_top_bg"></div>
        <div class="ask-price">
            <strong class="title">提交个人信息，享受一对一的服务</strong>
            <ul class="register">
                <li class="frist-select">
                    <a href="###" data-action="firstmodels" data-id="2593">
                        <label>当前车型：</label>
                        <strong>2013款 40 TFSI quattro 自动 个性运动型</strong>
                    </a>
                </li>
                <li>
                    <label>姓<em class="w28"></em>名：</label>
                    <input type="text"  value="请输入您的姓名" />
                </li>
                <li>
                    <label>手<em class="w6"></em>机<em class="w6"></em>号：</label>
                    <input type="text" class="current" value="133666330" />
                    <!--输入加 input 加  class="current" 样式-->
                </li>
                 <li class="frist-select" data-action="province">
                    <a href="###">
                        <label>城<em class="w28"></em>市：</label>
                        <strong>北京</strong>
                    </a>
                </li>
            </ul>
            <strong class="title">推荐经销商（已选<em class="font-red">3</em>家）</strong>
            <ul class="dealer-list">
                <li>
                    <div class="leftbox">
                        <i class="checkbox checked"></i>
                    </div>
                    <h6><em>4S-</em>北京运通兴捷</h6>
                    <p>地址：北京市大兴区西红门镇中鼎路23号</p>
                    <p>电话：400-100-10000</p>
                     <div class="flex-right">
                        <a href="###" class="phone">
                            通话
                        </a>
                    </div>
                </li>
                <li>
                    <div class="leftbox">
                        <i class="checkbox checked"></i>
                    </div>
                    <h6><em>4S-</em>北京运通兴捷</h6>
                    <p>地址：北京市大兴区西红门镇中鼎路23号</p>
                    <p>电话：400-100-10000</p>
                    <p>电话：400-100-10000<em class="right-text">短信秒回</em></p>
                    <div class="flex-right">
                        <a href="###" class="phone">
                            通话
                        </a>
                    </div>
                </li>
                <li>
                    <div class="leftbox">
                        <i class="checkbox checked"></i>
                    </div>
                    <h6>北京运通兴捷</h6>
                    <p>地址：北京市大兴区西红门镇中鼎路23号</p>
                    <p>电话：400-100-10000</p>
                    <p>电话：400-100-10000<em class="right-text">短信秒回</em></p>
                     <div class="flex-right">
                        <a href="###" class="phone">
                            通话
                        </a>
                    </div>
                </li>
                <li>
                    <div class="leftbox">
                        <i class="checkbox"></i>
                    </div>
                    <h6>北京运通兴捷</h6>
                    <p>地址：北京市大兴区西红门镇中鼎路23号</p>
                    <p>电话：400-100-10000</p>
                     <div class="flex-right">
                        <a href="###" class="phone">
                            通话
                        </a>
                    </div>
                </li>
                <li>
                    <div class="leftbox">
                        <i class="checkbox"></i>
                    </div>
                    <h6>北京运通兴捷</h6>
                    <p>地址：北京市大兴区西红门镇中鼎路23号</p>
                    <p>电话：400-100-10000</p>
                     <div class="flex-right">
                        <a href="###" class="phone">
                            通话
                        </a>
                    </div>
                </li>
            </ul>
            <div class="lnk-more">
                <a href="javascript:;">收起全部<span class="arrow_down up"></span></a><!--展开全部-->
            </div>
           
        </div>
    </div>
    <div class="flex-bottom">
         <button class="submit remove-margin-top"><a href="#">咨询低价</a></button>
    </div>
</body>
</html>
<!--车款层 start-->
    <div class="leftmask mark leftmask3" style="display: none;"></div>
    <div class="leftPopup car-model firstmodels original" data-back="leftmask3" style="display: none" data-key="model">
        <div class="swipeLeft swipeLeft-sub">
            <div class="loading">
                <img src="http://image.bitautoimg.com/uimg/mbt2015/images/loading.gif" />
                <p>正在加载...</p>
            </div>
        </div>
    </div>
<!--车款层 end-->
<!--loading模板 start -->
<div class="template-loading" style="display: none;">
    <div class="loading">
        <img src="http://image.bitautoimg.com/uimg/mbt2015/images/loading.gif" />
        <p>正在加载...</p>
    </div>
</div>
<!--loading模板 end -->
<!--车款模板 start-->
<script type="text/template" id="firstModelsTemplate">
    { for(var n in CarList){ }
        {var iszx = arrMark[n.replace('s', '')]}
        <div class="tt-small" {= !iszx ? 'data-slider="pic-txt-h"':''} >
            <span>{= n.replace('s','') }
                {if(!iszx){}
                <em>[停售]</em>
                {}}
            </span>
            {if(!iszx){}
            <i></i>
            {}}
        </div>

    <!-- 图文混排横向 start -->
    <div class="pic-txt-h pic-txt-9060 tone {=iszx?'open':''}">
        <ul>
            {for(var i=0;i < CarList[n].length;i++){}
            <li {= CarList[n][i].CarId.toString() == (api.model.currentid.toString()) ? 'class="current"':''}">
                <a href="#" data-id="{= CarList[n][i].CarId}" >
                    <h4>{= CarList[n][i].CarName}</h4>
                    <p><strong>{= CarList[n][i].Price}</strong></p>
                </a>
            </li>
            {}}
        </ul>
    </div>
    {}}
</script>
<!--车款模板 end-->

    <!--省份层 start-->
    <div class="leftPopup province year" data-back="leftmask3" style="display: none;">
        <div class="swipeLeft swipeLeft-sub">
            <div class="loading">
                <img src="http://image.bitautoimg.com/uimg/mbt2015/images/loading.gif" />
                <p>正在加载...</p>
            </div>
        </div>
    </div>
    <!--省份层 end-->

    <!--市层 start-->
    <div class="leftPopup month model2 city" data-back="leftmask3" style="display: none;">
        <div class="swipeLeft swipeLeft-sub">
            <div class="loading">
                <img src="http://image.bitautoimg.com/uimg/mbt2015/images/loading.gif" />
                <p>正在加载...</p>
            </div>
        </div>
    </div>
    <!--市层 end-->

    <!--省模板start-->
    <script type="text/template" id="provinceTemplate">
        <dl class="tt-list">
            { for(var n in provinces){}
            <dt><span>{=n}</span></dt>
                {for(var i=0;i<provinces[n].length;i++){}
                <dd>
                    <a href="#" {=provinces[n][i].children ? 'data-action="city"':''}  data-id="{=provinces[n][i].id}" class="{=provinces[n][i].children ? '':'nbg'} {= provinces[n][i].id.toString() == current_province.toString()  ? 'current':''}">
                        <p>{=provinces[n][i].name}</p>
                    </a>
                </dd>
               {}}
            {}}
        </dl>
    </script>
    <!--省模板end-->

    <!--市模板start-->
    <script type="text/template" id="cityTemplate">
        <div class="ap">
            <ul class="first-list rp">
                <li class="root"><a>安徽</a></li>
                {for(var i=0;i  <citys.length;i++){}
                    <li><a data-id="{=citys[i].id}" class="{= citys[i].id.toString() == current_city.toString()  ? 'current':''}">{=citys[i].name}</a></li>
                {}}
            </ul>
        </div>
    </script>
    <!--市模板end-->

<script src="http://image.bitautoimg.com/uimg/wap/js/jquery-1.8.0.min.js" type="text/javascript"></script>
<script type="text/javascript" src="http://image.bitautoimg.com/uimg/mbt2015/js/underscore.js"></script>
<script type="text/javascript" src="http://image.bitautoimg.com/uimg/mbt2015/js/iscroll20160222.js"></script>
<script src="http://image.bitautoimg.com/uimg/mbt2015/js/model20160222.js" type="text/javascript"></script>
<script type="text/javascript" src="http://image.bitautoimg.com/uimg/mbt2015/js/rightswipe20160222.js"></script>
<script type="text/javascript">
    var current_province = 2, //默认选中年
        current_city = 201;


    //省份模拟json //第一层数据源
    var provinces = {
        'A': [{ id: '1', name: '安徽省', children: true }],
        'B': [{ id: '2', name: '北京', children: false }],
        'C': [{ id: '3', name: '重庆', children: false }],
        'F': [{ id: '4', name: '福建省', children: true }],
        'G': [{ id: '5', name: '甘肃省', children: true },
              { id: '6', name: '广东省', children: true },
              { id: '7', name: '广西壮族自治区', children: true },
              { id: '8', name: '贵州省', children: true }],
        'H': [{ id: '9', name: '海南省', children: true },
              { id: '10', name: '河北省', children: true },
              { id: '11', name: '黑龙江省', children: true },
              { id: '12', name: '湖南省', children: true },
              { id: '13', name: '湖北省', children: true }],
    },
    //城市模拟json //第二层数据源
    citys = {
        '1': [
            { id: 101, name: '合肥' },
            { id: 102, name: '安庆' },
            { id: 103, name: '蚌埠' },
            { id: 104, name: '巢湖' },
            { id: 105, name: '池州' },
            { id: 106, name: '阜阳' },
            { id: 107, name: '淮北' },
            { id: 108, name: '淮南' },
            { id: 109, name: '六安' },
            { id: 110, name: '马鞍山' },
            { id: 111, name: '铜陵' },
            { id: 112, name: '芜湖' },
            { id: 113, name: '宣城' },
            { id: 114, name: '滁州' },
            { id: 115, name: '黄山' },
            { id: 116, name: '宿州' }],
        '2': [{ id: 201, name: '北京市' }],
        '3': [{ id: 301, name: '重庆市' }],
        '4': [{ id: 401, name: '泉州' },
              { id: 402, name: '南平' },
              { id: 409, name: '宁德' },
              { id: 410, name: '三明' },
              { id: 403, name: '福州' },
              { id: 404, name: '厦门' },
              { id: 405, name: '龙岩' },
              { id: 406, name: '漳州' },
              { id: 407, name: '莆田' }]
    }


    $(function () {
        var $body = $('body');
        $body.trigger('rightswipe1',
            {
                actionName: '[data-action=firstmodels]',
                fliterTemplate: function (templateid, paras) {
                    return "#firstModelsTemplate";
                },
                onBeforeScrollStart: function (ev) { },
                fnEnd: function () {
                    var $swipeLeft = this;
                    console.log($swipeLeft)
                    console.log('打开弹出层')
                }
            });

        api.model.currentid = '116517';
        //车款点击回调事件
        api.model.clickEnd = function (paras) {
            console.log(paras)
            //车款ID
            console.log('车款ID：' + paras.modelid)
            api.model.currentid = paras.modelid;
            var $back = $('.' + $leftPopupModels.attr('data-back'));
            //关闭浮层
            //$back.trigger('close');
        }

        //城市

        var childs = [];
        //二级连选  publicselect2 是二级连选控件
        $body.trigger('publicselect2',
          {
              controlName1: 'publicswipe1', //调用公共一级控件
              actionName1: '[data-action=province]', //绑定第一次属性
              actionName2: '[data-action=city]', //绑定第二次属性
              ds1: provinces,//第一层数据源
              ds2: citys,//第二层数据源
              templateid1: '#provinceTemplate', //第一层模板ID
              templateid2: '#cityTemplate',// 第二层模板ID
              snap1: 'dt,dd', //自动对齐标签
              flatFn1: function (data) { //不修改数据源个格式这块删除
                  //修改第一层数据源格式 
                  return data;
              },
              flatFn2: function (data) { //不修改数据源个格式这块删除
                  //console.log(data)
                  //修改第二层数据源格式
                  return data;
              },
              fliterTemplate: function (templateid, f) {
                  //返回默认模板
                  return templateid;
              },
              fliterData: function (ds, f) {
                  var data = [];
                  for (var n in ds) { //筛选 第二层数据
                      if (n.toString() == f.$current.attr('data-id').toString()) {
                          data = ds[n];
                      }
                  }
                  return { citys: data };
              },
              fnEnd1: function (paras) {
                  //console.log('打开第一层后回调')
                  var $swipeLeft = this,
                      $leftPopupModels = $swipeLeft.parent(),
                      $back = $('.' + $leftPopupModels.attr('data-back'));
                  $swipeLeft.find('a.nbg').click(function (ev) {
                      var $click = $(this);
                      ev.preventDefault();
                      current_province = $click.attr('data-id');
                      console.log(current_province);
                      $back.trigger('close');
                  })
              },
              fnEnd2: function (paras) {
                  //console.log('打开第二层后回调')
                  var $swipeLeft = this,
                        $leftPopupModels = $swipeLeft.parent(),
                        $back = $('.' + $leftPopupModels.attr('data-back')),
                        $a = $swipeLeft.find('.root a');

                  //$a.html(paras.$current.html());

                  //返回按钮事件
                  $swipeLeft.find('.root a').click(function (ev) {
                      ev.preventDefault();
                      $back.trigger('close', { leftPopup: $leftPopupModels });
                  });

                  //选中按钮事件
                  $swipeLeft.find('li:not(.root) a').click(function (ev) {
                      ev.preventDefault();
                      var $current = $(this);
                      current_province = paras.$current.attr('data-id');
                      current_city = $current.attr('data-id');
                      console.log(paras.$current.attr('data-id'), $current.attr('data-id'))
                      //alert($current.html())
                      //关闭层
                      $back.trigger('close');
                  });
              }
          });
    })
    </script>